# Norden Engine v3.1 é…ç½®å‚æ•°è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æ‰€æœ‰é…ç½®å‚æ•°å·²é›†ä¸­åˆ° `config.py` æ–‡ä»¶ä¸­ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†å’Œè°ƒä¼˜ã€‚

**ä½¿ç”¨æ–¹å¼**ï¼š

```python
from norden_v3 import MakerConfig, KalmanConfig, PresetConfigs

# æ–¹å¼ 1ï¼šä½¿ç”¨é»˜è®¤é…ç½®
engine = NordenMakerV3()

# æ–¹å¼ 2ï¼šè‡ªå®šä¹‰é…ç½®
my_config = MakerConfig(base_spread_threshold=1.0)
engine = NordenMakerV3(maker_cfg=my_config)

# æ–¹å¼ 3ï¼šä½¿ç”¨é¢„è®¾é…ç½®
conservative_config = PresetConfigs.conservative()
engine = NordenMakerV3(maker_cfg=conservative_config)
```

---

## âš™ï¸ é…ç½®ç±»åˆ—è¡¨

| é…ç½®ç±» | æ¨¡å— | è¯´æ˜ |
|--------|------|------|
| `MakerConfig` | ç­–ç•¥å¼•æ“ | ç­–ç•¥ä¸»å¼•æ“å‚æ•° |
| `KalmanConfig` | å¡å°”æ›¼æ»¤æ³¢ | å®šä»·æ¨¡å‹å‚æ•° |
| `RidgeConfig` | å²­å›å½’ | å¤‡ç”¨å®šä»·æ¨¡å‹å‚æ•° |
| `OBIConfig` | OBI è®¡ç®— | è®¢å•ç°¿å¤±è¡¡åº¦å‚æ•° |
| `IcebergConfig` | å†°å±±æ£€æµ‹ | å†°å±±è®¢å•æ£€æµ‹å‚æ•° |
| `BTCRegimeConfig` | BTC ç›‘æ§ | BTC é£é™©ç›‘æ§å‚æ•° |

---

## ğŸ“Š é…ç½®å‚æ•°é€ŸæŸ¥è¡¨

### 1. MakerConfigï¼ˆç­–ç•¥ä¸»å¼•æ“ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ |
|------|------|--------|------|------|
| `base_spread_threshold` | float | 0.5 | tick | Spread è§¦å‘é˜ˆå€¼ |
| `min_obi_for_long` | float | 0.1 | - | åšå¤šæœ€å° OBI |
| `min_obi_for_short` | float | 0.1 | - | åšç©ºæœ€å° OBI |
| `obi_depth` | int | 10 | æ¡£ | OBI è®¡ç®—æ·±åº¦ |
| `max_queue_size` | int | 300 | æ‰‹ | æœ€å¤§é˜Ÿåˆ—é•¿åº¦ |
| `max_wait_seconds` | float | 3.0 | ç§’ | æŒ‚å•æœ€é•¿ç­‰å¾…æ—¶é—´ |
| `hard_stop_seconds` | float | 10.0 | ç§’ | æŒä»“æœ€é•¿æŒæœ‰æ—¶é—´ |
| `take_profit_ticks` | float | 4.0 | tick | æ­¢ç›ˆé˜ˆå€¼ |
| `hard_stop_ticks` | float | 6.0 | tick | æ­¢æŸé˜ˆå€¼ |

### 2. KalmanConfigï¼ˆå¡å°”æ›¼æ»¤æ³¢ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `init_P` | float | 100.0 | åˆå§‹åæ–¹å·® |
| `q_beta` | float | 1e-12 | Beta è¿‡ç¨‹å™ªå£° |
| `q_alpha` | float | 1e-6 | Alpha è¿‡ç¨‹å™ªå£° |
| `r_obs` | float | 100.0 | è§‚æµ‹å™ªå£° |

### 3. RidgeConfigï¼ˆå²­å›å½’ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `lambda_factor` | float | 0.995 | é—å¿˜å› å­ |
| `ridge_alpha` | float | 1e-4 | å²­æƒ©ç½šç³»æ•° |
| `init_P` | float | 100.0 | åˆå§‹åæ–¹å·® |

### 4. OBIConfigï¼ˆOBI è®¡ç®—ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `depth` | int | 10 | è®¡ç®—æ·±åº¦ï¼ˆæ¡£æ•°ï¼‰ |
| `decay` | float | 0.5 | æƒé‡è¡°å‡ç³»æ•° |
| `auto_adjust_depth` | bool | True | è‡ªåŠ¨è°ƒæ•´æ·±åº¦ |

### 5. IcebergConfigï¼ˆå†°å±±æ£€æµ‹ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ |
|------|------|--------|------|------|
| `min_hidden_size` | int | 10 | æ‰‹ | æœ€å°éšè—é‡é˜ˆå€¼ |
| `decay_seconds` | float | 60.0 | ç§’ | å†°å±±è¡°å‡æ—¶é—´ |
| `price_tolerance` | float | 1e-5 | - | ä»·æ ¼å®¹å·® |
| `check_range_ticks` | int | 4 | tick | æ£€æŸ¥èŒƒå›´ |

### 6. BTCRegimeConfigï¼ˆBTC ç›‘æ§ï¼‰

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | å•ä½ | è¯´æ˜ |
|------|------|--------|------|------|
| `short_window_seconds` | int | 60 | ç§’ | çŸ­æœŸæ³¢åŠ¨ç‡çª—å£ |
| `long_window_seconds` | int | 600 | ç§’ | é•¿æœŸåŸºå‡†æ³¢åŠ¨ç‡çª—å£ |
| `alert_threshold` | float | 3.0 | - | æŠ¥è­¦é˜ˆå€¼ï¼ˆæ¯”ç‡ï¼‰ |
| `sample_interval_seconds` | float | 1.0 | ç§’ | é‡‡æ ·é¢‘ç‡ |

---

## ğŸ¯ é¢„è®¾é…ç½®æ¨¡æ¿

### PresetConfigs.conservative() - ä¿å®ˆé…ç½®

**ç‰¹ç‚¹**ï¼šä½é¢‘ç‡ï¼Œé«˜èƒœç‡

```python
from norden_v3 import PresetConfigs

config = PresetConfigs.conservative()
engine = NordenMakerV3(maker_cfg=config)
```

**å‚æ•°**ï¼š
- `base_spread_threshold = 1.5` tick
- `min_obi_for_long/short = 0.2`
- `max_queue_size = 200` æ‰‹
- `take_profit_ticks = 3.0`
- `hard_stop_ticks = 4.0`

### PresetConfigs.aggressive() - æ¿€è¿›é…ç½®

**ç‰¹ç‚¹**ï¼šé«˜é¢‘ç‡ï¼Œæ•è·æ›´å¤šæœºä¼š

```python
config = PresetConfigs.aggressive()
engine = NordenMakerV3(maker_cfg=config)
```

**å‚æ•°**ï¼š
- `base_spread_threshold = 0.3` tick
- `min_obi_for_long/short = 0.05`
- `max_queue_size = 400` æ‰‹
- `take_profit_ticks = 6.0`
- `hard_stop_ticks = 10.0`

### PresetConfigs.balanced() - å¹³è¡¡é…ç½®

**ç‰¹ç‚¹**ï¼šé»˜è®¤é…ç½®ï¼ˆæ¨èï¼‰

```python
config = PresetConfigs.balanced()
engine = NordenMakerV3(maker_cfg=config)
```

---

## ğŸ“– è¯¦ç»†å‚æ•°è¯´æ˜

è¯¦è§ `config.py` æ–‡ä»¶ä¸­çš„è¯¦ç»†æ³¨é‡Šï¼Œæ¯ä¸ªå‚æ•°éƒ½æœ‰ï¼š

- âœ… **å‚æ•°è¯´æ˜**ï¼šå‚æ•°çš„ä½œç”¨å’Œå«ä¹‰
- âœ… **è°ƒä¼˜å»ºè®®**ï¼šä¸åŒåœºæ™¯ä¸‹çš„æ¨èå€¼
- âœ… **è®¡ç®—å…¬å¼**ï¼šç›¸å…³çš„æ•°å­¦å…¬å¼ï¼ˆå¦‚é€‚ç”¨ï¼‰

---

## ğŸ”§ é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šè‡ªå®šä¹‰ç­–ç•¥é…ç½®

```python
from norden_v3 import NordenMakerV3, MakerConfig

# åˆ›å»ºè‡ªå®šä¹‰é…ç½®
my_config = MakerConfig(
    base_spread_threshold=0.8,    # 0.8 tick è§¦å‘
    min_obi_for_long=0.15,        # æ›´ä¸¥æ ¼çš„åšå¤šæ¡ä»¶
    max_queue_size=250,           # ä¸­ç­‰é˜Ÿåˆ—é™åˆ¶
    take_profit_ticks=5.0,        # æ›´å¤§æ­¢ç›ˆ
    hard_stop_ticks=8.0,          # æ›´å¤§æ­¢æŸ
)

engine = NordenMakerV3(maker_cfg=my_config)
```

### ç¤ºä¾‹ 2ï¼šè‡ªå®šä¹‰æ¨¡å‹é…ç½®

```python
from norden_v3 import NordenMakerV3, KalmanConfig

# åˆ›å»ºè‡ªå®šä¹‰ Kalman é…ç½®
kalman_cfg = KalmanConfig(
    r_obs=150.0,      # æ›´å¼ºçš„ Spreadï¼ˆæ›´ä¸ä¿¡ä»»å®é™…ä»·æ ¼ï¼‰
    q_beta=1e-13,     # Beta æ›´ç¨³å®š
)

engine = NordenMakerV3(kalman_cfg=kalman_cfg)
```

### ç¤ºä¾‹ 3ï¼šå®Œæ•´è‡ªå®šä¹‰é…ç½®

```python
from norden_v3 import (
    NordenMakerV3,
    MakerConfig,
    KalmanConfig,
    OBIConfig,
    IcebergConfig,
    BTCRegimeConfig,
)

# ç­–ç•¥é…ç½®
maker_cfg = MakerConfig(base_spread_threshold=0.6)

# Kalman é…ç½®
kalman_cfg = KalmanConfig(r_obs=120.0)

# OBI é…ç½®ï¼ˆåœ¨å¼•æ“å†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜¾å¼é…ç½®ï¼‰
obi_cfg = OBIConfig(depth=12, decay=0.6)

# å†°å±±é…ç½®ï¼ˆåœ¨å¼•æ“å†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜¾å¼é…ç½®ï¼‰
iceberg_cfg = IcebergConfig(min_hidden_size=15)

# BTC ç›‘æ§é…ç½®ï¼ˆåœ¨å¼•æ“å†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜¾å¼é…ç½®ï¼‰
btc_cfg = BTCRegimeConfig(alert_threshold=2.5)

engine = NordenMakerV3(
    maker_cfg=maker_cfg,
    kalman_cfg=kalman_cfg,
    # æ³¨æ„ï¼šOBI/Iceberg/BTC é…ç½®éœ€è¦é€šè¿‡ä¿®æ”¹å¼•æ“å†…éƒ¨é€»è¾‘æ¥ä¼ å…¥
    # å½“å‰ç‰ˆæœ¬æš‚ä¸æ”¯æŒç›´æ¥ä¼ å…¥ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤é…ç½®
)
```

---

## âš ï¸ è°ƒä¼˜æ³¨æ„äº‹é¡¹

### 1. Spread é˜ˆå€¼è°ƒä¼˜

- **è¿‡å°**ï¼ˆ< 0.3 tickï¼‰ï¼šä¼šäº§ç”Ÿè¿‡å¤šå‡ä¿¡å·
- **è¿‡å¤§**ï¼ˆ> 2.0 tickï¼‰ï¼šä¼šé”™è¿‡å¾ˆå¤šæœºä¼š
- **æ¨è**ï¼š0.5-1.0 tick

### 2. Kalman å‚æ•°è°ƒä¼˜

- **r_obs**ï¼šå½±å“ Spread å¤§å°ï¼Œå€¼è¶Šå¤§ Spread è¶Šå¤§
- **q_beta/q_alpha**ï¼šå½±å“å‚æ•°ç¨³å®šæ€§ï¼Œå€¼è¶Šå°è¶Šç¨³å®š
- **å»ºè®®**ï¼šå…ˆä½¿ç”¨é»˜è®¤å€¼ï¼Œè§‚å¯Ÿæ•ˆæœåå†å¾®è°ƒ

### 3. OBI å‚æ•°è°ƒä¼˜

- **depth**ï¼šæ ¹æ®å¸‚åœºåšåº¦è°ƒæ•´ï¼Œåšå¸‚åœºå¯ä»¥çœ‹æ›´å¤šæ¡£
- **decay**ï¼šæ ¹æ®å¸‚åœºå™ªå£°è°ƒæ•´ï¼Œå™ªå£°å¤§æ—¶å¢å¤§ decay

### 4. BTC ç›‘æ§è°ƒä¼˜

- **alert_threshold**ï¼šæ ¹æ®é£é™©æ‰¿å—èƒ½åŠ›è°ƒæ•´
- **ä¿å®ˆç­–ç•¥**ï¼š2.0-2.5ï¼ˆæ›´å®¹æ˜“è§¦å‘ç†”æ–­ï¼‰
- **æ¿€è¿›ç­–ç•¥**ï¼š3.5-4.0ï¼ˆæ›´å°‘è§¦å‘ç†”æ–­ï¼‰

---

**é…ç½®æ–‡ä»¶ä½ç½®**ï¼š`norden_v3/config.py`  
**æœ€åæ›´æ–°**ï¼š2025-01-19

